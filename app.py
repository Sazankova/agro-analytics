import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
import numpy as np
from datetime import datetime, timedelta
import random

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–µ–≤–æ–¥—Å—Ç–≤–∞ –†–æ—Å—Å–∏–∏",
    page_icon="üåæ",
    layout="wide",
    initial_sidebar_state="expanded"
)

# –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
st.title('üåæ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–µ–≤–æ–¥—Å—Ç–≤–∞ –†–æ—Å—Å–∏–∏')
st.markdown("**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —ç–∫—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ –∏ –¥–∏–Ω–∞–º–∏–∫–∏ —Ü–µ–Ω —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∞–≥—Ä–æ—Ö–æ–ª–¥–∏–Ω–≥–æ–≤**")

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã
def load_company_data():
    data = {
        '‚Ññ': range(1, 16),
        '–†–µ–≥–∏–æ–Ω –†–§': [
            '–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª.', '–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª.', '–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª.', '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π',
            '–ö—É—Ä—Å–∫–∞—è –æ–±–ª.', '–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª.', '–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π', '–¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω',
            '–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª.', '–õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª.', '–¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª.',
            '–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª.', '–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª.', '–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª.'
        ],
        '–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏': [
            '–ê–ü–• "–ú–∏—Ä–∞—Ç–æ—Ä–≥"', '–ì–ö "–ê–≥—Ä–æ-–ë–µ–ª–æ–≥–æ—Ä—å–µ"', '–ì–ö "–≠–∫–æ–ù–∏–≤–∞"', '–ê–û "–ü—Ä–æ–¥–∏–º–µ–∫—Å"',
            '–ì–ö "–ê–≥—Ä–æ–ø—Ä–æ–º–∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è"', '"–Æ–≥-–ê–≥—Ä–æ—Ö–æ–ª–¥–∏–Ω–≥"', '"–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å–µ" –ê–ü–ö',
            '"–ö—Ä–∞—Å–Ω—ã–π –í–æ—Å—Ç–æ–∫ –ê–≥—Ä–æ"', '"–ê–≥—Ä–æ—Å–∏–±-–†–∞–∑–¥–æ–ª—å–µ"', '"–°–∏–±–∏—Ä—Å–∫–∞—è –ê–≥—Ä–∞—Ä–Ω–∞—è –ì—Ä—É–ø–ø–∞"',
            '"–ê–≥—Ä–æ—Ñ–∏—Ä–º–∞ –∏–º–µ–Ω–∏ 15 –ª–µ—Ç –û–∫—Ç—è–±—Ä—è"', '"–ê–≥—Ä–æ—Ñ–∏—Ä–º–∞ "–†—É—Å—Å–∫–∞—è –ë–µ—Ä—ëzka"',
            '"–û—Ä–ª–æ–≤—Å–∫–∞—è –ù–∏–≤–∞"', '"–ë—Ä—è–Ω—Å–∫–∞—è –∞–≥—Ä–∞—Ä–Ω–∞—è –≥—Ä—É–ø–ø–∞"', '"–ü–µ–Ω–∑–µ–Ω—Å–∫–∏–µ –∞–≥—Ä–∞—Ä–∏–∏"'
        ],
        '–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è': [
            '–ó–µ—Ä–Ω–æ–≤—ã–µ, –º–∞—Å–ª–æ–∂–∏—Ä–æ–≤—ã–µ', '–ó–µ—Ä–Ω–æ–≤—ã–µ, –º–∞—Å–ª–æ–∂–∏—Ä–æ–≤—ã–µ', '–ó–µ—Ä–Ω–æ–≤—ã–µ, –∫–æ—Ä–º–æ–≤—ã–µ',
            '–ó–µ—Ä–Ω–æ–≤—ã–µ, —Å–∞—Ö–∞—Ä', '–ó–µ—Ä–Ω–æ–≤—ã–µ, –º–∞—Å–ª–æ–∂–∏—Ä–æ–≤—ã–µ', '–ó–µ—Ä–Ω–æ–≤—ã–µ', '–ó–µ—Ä–Ω–æ–≤—ã–µ, –æ–≤–æ—â–∏',
            '–ó–µ—Ä–Ω–æ–≤—ã–µ', '–ó–µ—Ä–Ω–æ–≤—ã–µ, –º–∞—Å–ª–æ–∂–∏—Ä–æ–≤—ã–µ', '–ó–µ—Ä–Ω–æ–≤—ã–µ', '–ó–µ—Ä–Ω–æ–≤—ã–µ, —Å–≤–µ–∫–ª–∞',
            '–ó–µ—Ä–Ω–æ–≤—ã–µ, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫', '–ó–µ—Ä–Ω–æ–≤—ã–µ', '–ó–µ—Ä–Ω–æ–≤—ã–µ, –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å', '–ó–µ—Ä–Ω–æ–≤—ã–µ, –º–∞—Å–ª–æ–∂–∏—Ä–æ–≤—ã–µ'
        ],
        '–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è': [
            '–ü—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫, —Ä–∞–ø—Å', '–Ø—á–º–µ–Ω—å, –∫—É–∫—É—Ä—É–∑–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫',
            '–ü—à–µ–Ω–∏—Ü–∞, –∫—É–∫—É—Ä—É–∑–∞, –≥–æ—Ä–æ—Ö', '–ü—à–µ–Ω–∏—Ü–∞, –∫—É–∫—É—Ä—É–∑–∞, —Å–∞—Ö–∞—Ä',
            '–ü—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫, —Å–æ—è', '–ü—à–µ–Ω–∏—Ü–∞, —è—á–º–µ–Ω—å', '–ü—à–µ–Ω–∏—Ü–∞, –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å, –º–æ—Ä–∫–æ–≤—å',
            '–ü—à–µ–Ω–∏—Ü–∞, —è—á–º–µ–Ω—å, –≥–æ—Ä–æ—Ö', '–ü—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫, –ª–µ–Ω', '–ü—à–µ–Ω–∏—Ü–∞, –æ–≤–µ—Å',
            '–ü—à–µ–Ω–∏—Ü–∞, —Å–∞—Ö–∞—Ä–Ω–∞—è —Å–≤–µ–∫–ª–∞', '–ü—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫', '–ü—à–µ–Ω–∏—Ü–∞, —è—á–º–µ–Ω—å, –≥—Ä–µ—á–∏—Ö–∞',
            '–ü—à–µ–Ω–∏—Ü–∞, –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å', '–ü—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫'
        ],
        '–ì–æ–¥–æ–≤–æ–π –æ–±–æ—Ä–æ—Ç': [
            '>100 –º–ª—Ä–¥ —Ä—É–±.', '50-100 –º–ª—Ä–¥ —Ä—É–±.', '>100 –º–ª—Ä–¥ —Ä—É–±.', '>100 –º–ª—Ä–¥ —Ä—É–±.',
            '50-100 –º–ª—Ä–¥ —Ä—É–±.', '10-50 –º–ª—Ä–¥ —Ä—É–±.', '10-50 –º–ª—Ä–¥ —Ä—É–±.', '50-100 –º–ª—Ä–¥ —Ä—É–±.',
            '50-100 –º–ª—Ä–¥ —Ä—É–±.', '10-50 –º–ª—Ä–¥ —Ä—É–±.', '10-50 –º–ª—Ä–¥ —Ä—É–±.', '10-50 –º–ª—Ä–¥ —Ä—É–±.',
            '10-50 –º–ª—Ä–¥ —Ä—É–±.', '10-50 –º–ª—Ä–¥ —Ä—É–±.', '10-50 –º–ª—Ä–¥ —Ä—É–±.'
        ],
        '–ü–æ—Å–µ–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∏ (–≥–∞)': [
            600000, 250000, 600000, 500000, 300000, 150000, 120000, 350000,
            280000, 100000, 85000, 95000, 110000, 75000, 80000
        ],
        '–≠–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)': [
            450000, 180000, 350000, 700000, 220000, 90000, 60000, 150000,
            200000, 45000, 35000, 50000, 55000, 25000, 40000
        ],
        '–î–æ–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ': [
            '25%', '30%', '20%', '45%', '30%', '25%', '20%', '15%',
            '30%', '18%', '15%', '20%', '18%', '12%', '18%'
        ],
        '–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∞': [
            '–ï–≥–∏–ø–µ—Ç, –¢—É—Ä—Ü–∏—è, –ë–ª–∏–∂–Ω–∏–π –í–æ—Å—Ç–æ–∫', '–¢—É—Ä—Ü–∏—è, –ï–≥–∏–ø–µ—Ç, —Å—Ç—Ä–∞–Ω—ã –°–ù–ì',
            '–ï–≥–∏–ø–µ—Ç, –¢—É—Ä—Ü–∏—è, –ò—Ä–∞–Ω', '–ï–≥–∏–ø–µ—Ç, –¢—É—Ä—Ü–∏—è, –°–∞—É–¥–æ–≤—Å–∫–∞—è –ê—Ä–∞–≤–∏—è',
            '–¢—É—Ä—Ü–∏—è, –ï–≥–∏–ø–µ—Ç, –°–µ–≤–µ—Ä–Ω–∞—è –ê—Ñ—Ä–∏–∫–∞', '–¢—É—Ä—Ü–∏—è, –ï–≥–∏–ø–µ—Ç',
            '–ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω, –ì—Ä—É–∑–∏—è, —Å—Ç—Ä–∞–Ω—ã –°–ù–ì', '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ê–∑–∏—è, –ë–ª–∏–∂–Ω–∏–π –í–æ—Å—Ç–æ–∫',
            '–ö–∏—Ç–∞–π, –ú–æ–Ω–≥–æ–ª–∏—è, –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ê–∑–∏—è', '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ê–∑–∏—è, –ú–æ–Ω–≥–æ–ª–∏—è',
            '–ë–µ–ª–∞—Ä—É—Å—å, –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω', '–¢—É—Ä—Ü–∏—è, –ï–≥–∏–ø–µ—Ç', '–¢—É—Ä—Ü–∏—è, —Å—Ç—Ä–∞–Ω—ã –ë–∞–ª—Ç–∏–∏',
            '–ë–µ–ª–∞—Ä—É—Å—å, —Å—Ç—Ä–∞–Ω—ã –ë–∞–ª—Ç–∏–∏', '–¢—É—Ä—Ü–∏—è, –ò—Ä–∞–Ω'
        ],
        '–°–∞–π—Ç': [
            'miratorg.ru', 'agrobelogorie.ru', 'ekoniva.ru', 'prodimex.ru',
            'apkua.ru', 'ugagro.com', 'apk-stavropolye.ru', 'kea.ru',
            'agrosib-razdolie.ru', 'sibagrogroup.ru', 'af15.ru', 'rusbereza.ru',
            'orlniva.ru', 'bagroup.ru', 'penzagro.ru'
        ]
    }
    return pd.DataFrame(data)

def load_export_data():
    data = {
        '–ö–æ–º–ø–∞–Ω–∏—è': [
            '–ê–ü–• "–ú–∏—Ä–∞—Ç–æ—Ä–≥"', '–ì–ö "–≠–∫–æ–ù–∏–≤–∞"', '–ê–û "–ü—Ä–æ–¥–∏–º–µ–∫—Å"',
            '–ì–ö "–ê–≥—Ä–æ–ø—Ä–æ–º–∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è"', '"–ê–≥—Ä–æ—Å–∏–±-–†–∞–∑–¥–æ–ª—å–µ"', '"–ö—Ä–∞—Å–Ω—ã–π –í–æ—Å—Ç–æ–∫ –ê–≥—Ä–æ"'
        ],
        '–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)': [450000, 350000, 700000, 220000, 200000, 150000],
        '–ó–µ—Ä–Ω–æ–≤—ã–µ —ç–∫—Å–ø–æ—Ä—Ç': [300000, 280000, 600000, 150000, 150000, 120000],
        '–ú–∞—Å–ª–∏—á–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç': [150000, 70000, 0, 70000, 50000, 30000],
        '–ü—Ä–æ—á–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è': ['—Ä–∞–ø—Å, –∫–æ—Ä–º–∞', '—Å–µ–º–µ–Ω–∞, –≥–æ—Ä–æ—Ö', '—Å–∞—Ö–∞—Ä', '—Å–æ—è', '–ª–µ–Ω', '–≥–æ—Ä–æ—Ö'],
        '–û—Å–Ω–æ–≤–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã': [
            '–ß–µ—Ä–Ω–æ–µ –º–æ—Ä–µ, —Å—É—Ö–æ–ø—É—Ç–Ω—ã–µ', '–ß–µ—Ä–Ω–æ–µ –º–æ—Ä–µ, –ë–∞–ª—Ç–∏–∫–∞', '–ß–µ—Ä–Ω–æ–µ –º–æ—Ä–µ, –°—Ä–µ–¥–∏–∑–µ–º–Ω–æ–º–æ—Ä—å–µ',
            '–ß–µ—Ä–Ω–æ–µ –º–æ—Ä–µ', '–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã', '–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ, —Å—É—Ö–æ–ø—É—Ç–Ω—ã–µ'
        ],
        '–ö–ª—é—á–µ–≤—ã–µ –ø–æ—Ä—Ç—ã –æ—Ç–≥—Ä—É–∑–∫–∏': [
            '–ù–æ–≤–æ—Ä–æ—Å—Å–∏–π—Å–∫, –¢–∞–º–∞–Ω—å', '–ù–æ–≤–æ—Ä–æ—Å—Å–∏–π—Å–∫, –£—Å—Ç—å-–õ—É–≥–∞', '–ù–æ–≤–æ—Ä–æ—Å—Å–∏–π—Å–∫, –¢—É–∞–ø—Å–µ',
            '–ù–æ–≤–æ—Ä–æ—Å—Å–∏–π—Å–∫, –¢–∞–º–∞–Ω—å', '—á–µ—Ä–µ–∑ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω –≤ –ö–∏—Ç–∞–π', '–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å, —á–µ—Ä–µ–∑ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω'
        ]
    }
    return pd.DataFrame(data)

def load_region_data():
    data = {
        '–†–µ–≥–∏–æ–Ω': [
            '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π', '–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª.', '–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª.',
            '–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª.', '–ö—É—Ä—Å–∫–∞—è –æ–±–ª.', '–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π',
            '–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π', '–¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω'
        ],
        '–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (—Ç–æ–Ω–Ω)': [
            5000000, 3500000, 2000000, 1800000, 1200000, 1000000, 900000, 800000
        ],
        '–û—Å–Ω–æ–≤–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ –∫—É–ª—å—Ç—É—Ä—ã': [
            '–ø—à–µ–Ω–∏—Ü–∞, –∫—É–∫—É—Ä—É–∑–∞, —è—á–º–µ–Ω—å', '–ø—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫, —è—á–º–µ–Ω—å',
            '–ø—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫, —Ä–∞–ø—Å', '–ø—à–µ–Ω–∏—Ü–∞, –∫—É–∫—É—Ä—É–∑–∞, –≥–æ—Ä–æ—Ö',
            '–ø—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫, —Å–æ—è', '–ø—à–µ–Ω–∏—Ü–∞, –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫, –ª–µ–Ω',
            '–ø—à–µ–Ω–∏—Ü–∞, —è—á–º–µ–Ω—å, –∫—É–∫—É—Ä—É–∑–∞', '–ø—à–µ–Ω–∏—Ü–∞, —è—á–º–µ–Ω—å, –≥–æ—Ä–æ—Ö'
        ],
        '–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏-—ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã': [
            '–ü—Ä–æ–¥–∏–º–µ–∫—Å, –ê–§–ì –ù–∞—Ü–∏–æ–Ω–∞–ª—å, –Æ–≥ –†—É—Å–∏', '–Æ–≥-–ê–≥—Ä–æ—Ö–æ–ª–¥–∏–Ω–≥, –î–æ–Ω-–ê–≥—Ä–æ',
            '–ú–∏—Ä–∞—Ç–æ—Ä–≥, –ê–≥—Ä–æ-–ë–µ–ª–æ–≥–æ—Ä—å–µ', '–≠–∫–æ–ù–∏–≤–∞, –ß–µ—Ä–∫–∏–∑–æ–≤–æ-–†–∞—Å—Ç–µ–Ω–∏–µ–≤–æ–¥—Å—Ç–≤–æ',
            '–ê–≥—Ä–æ–ø—Ä–æ–º–∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è, –ö—É—Ä—Å–∫–∞–≥—Ä–æ', '–ê–≥—Ä–æ—Å–∏–±-–†–∞–∑–¥–æ–ª—å–µ, –ê–ª—Ç–∞–π—Å–∫–∏–µ –Ω–∏–≤—ã',
            '–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å–µ –ê–ü–ö, –°—Ç–∞–≤–ê–≥—Ä–æ', '–ö—Ä–∞—Å–Ω—ã–π –í–æ—Å—Ç–æ–∫ –ê–≥—Ä–æ, –¢–∞—Ç–ê–≥—Ä–æ'
        ],
        '–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è': [
            '–ï–≥–∏–ø–µ—Ç, –¢—É—Ä—Ü–∏—è, –ë–ª–∏–∂–Ω–∏–π –í–æ—Å—Ç–æ–∫', '–¢—É—Ä—Ü–∏—è, –ï–≥–∏–ø–µ—Ç, –°–µ–≤–µ—Ä–Ω–∞—è –ê—Ñ—Ä–∏–∫–∞',
            '–¢—É—Ä—Ü–∏—è, –ï–≥–∏–ø–µ—Ç, –ï–≤—Ä–æ–ø–∞', '–¢—É—Ä—Ü–∏—è, –ò—Ä–∞–Ω, –ë–ª–∏–∂–Ω–∏–π –í–æ—Å—Ç–æ–∫',
            '–¢—É—Ä—Ü–∏—è, –°–µ–≤–µ—Ä–Ω–∞—è –ê—Ñ—Ä–∏–∫–∞', '–ö–∏—Ç–∞–π, –ú–æ–Ω–≥–æ–ª–∏—è, –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ê–∑–∏—è',
            '–ó–∞–∫–∞–≤–∫–∞–∑—å–µ, —Å—Ç—Ä–∞–Ω—ã –°–ù–ì', '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ê–∑–∏—è, –ë–ª–∏–∂–Ω–∏–π –í–æ—Å—Ç–æ–∫'
        ]
    }
    return pd.DataFrame(data)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ü–µ–Ω–∞–º –∏ –æ–±—ä–µ–º–∞–º
def generate_historical_data():
    companies = [
        '–ê–ü–• "–ú–∏—Ä–∞—Ç–æ—Ä–≥"', '–ì–ö "–ê–≥—Ä–æ-–ë–µ–ª–æ–≥–æ—Ä—å–µ"', '–ì–ö "–≠–∫–æ–ù–∏–≤–∞"', '–ê–û "–ü—Ä–æ–¥–∏–º–µ–∫—Å"',
        '–ì–ö "–ê–≥—Ä–æ–ø—Ä–æ–º–∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è"', '"–Æ–≥-–ê–≥—Ä–æ—Ö–æ–ª–¥–∏–Ω–≥"', '"–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å–µ" –ê–ü–ö',
        '"–ö—Ä–∞—Å–Ω—ã–π –í–æ—Å—Ç–æ–∫ –ê–≥—Ä–æ"', '"–ê–≥—Ä–æ—Å–∏–±-–†–∞–∑–¥–æ–ª—å–µ"', '"–°–∏–±–∏—Ä—Å–∫–∞—è –ê–≥—Ä–∞—Ä–Ω–∞—è –ì—Ä—É–ø–ø–∞"',
        '"–ê–≥—Ä–æ—Ñ–∏—Ä–º–∞ –∏–º–µ–Ω–∏ 15 –ª–µ—Ç –û–∫—Ç—è–±—Ä—è"', '"–ê–≥—Ä–æ—Ñ–∏—Ä–º–∞ "–†—É—Å—Å–∫–∞—è –ë–µ—Ä—ëzka"',
        '"–û—Ä–ª–æ–≤—Å–∫–∞—è –ù–∏–≤–∞"', '"–ë—Ä—è–Ω—Å–∫–∞—è –∞–≥—Ä–∞—Ä–Ω–∞—è –≥—Ä—É–ø–ø–∞"', '"–ü–µ–Ω–∑–µ–Ω—Å–∫–∏–µ –∞–≥—Ä–∞—Ä–∏–∏"'
    ]
    
    products = ['–ü—à–µ–Ω–∏—Ü–∞', '–Ø—á–º–µ–Ω—å', '–ü–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫', '–ö—É–∫—É—Ä—É–∑–∞', '–†–∞–ø—Å', '–°–æ—è', '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å']
    
    # –ë–∞–∑–æ–≤—ã–µ —Ü–µ–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (—Ä—É–±/—Ç–æ–Ω–Ω–∞)
    base_prices = {
        '–ü—à–µ–Ω–∏—Ü–∞': 15000,
        '–Ø—á–º–µ–Ω—å': 12000,
        '–ü–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫': 25000,
        '–ö—É–∫—É—Ä—É–∑–∞': 14000,
        '–†–∞–ø—Å': 28000,
        '–°–æ—è': 32000,
        '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å': 20000
    }
    
    historical_data = []
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞ 2018-2024 –≥–æ–¥—ã
    for year in range(2018, 2025):
        for month in range(1, 13):
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –±—É–¥—É—â–∏–µ –º–µ—Å—è—Ü—ã –≤ 2024
            if year == 2024 and month > datetime.now().month:
                continue
                
            date = datetime(year, month, 15)  # –°–µ—Ä–µ–¥–∏–Ω–∞ –º–µ—Å—è—Ü–∞
            
            for company in companies:
                for product in products:
                    # –ë–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º –ø—Ä–æ–¥–∞–∂ –∫–æ–º–ø–∞–Ω–∏–∏
                    company_factor = companies.index(company) * 0.1 + 1
                    
                    # –°–µ–∑–æ–Ω–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è
                    seasonal_factor = np.sin(month / 12 * 2 * np.pi) * 0.3 + 1
                    
                    # –¢—Ä–µ–Ω–¥ —Ä–æ—Å—Ç–∞ –∑–∞ –≥–æ–¥—ã
                    trend_factor = 1 + (year - 2018) * 0.05
                    
                    # –°–ª—É—á–∞–π–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è
                    random_factor = np.random.normal(1, 0.15)
                    
                    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—ä–µ–º
                    base_volume = base_prices[product] / 100  # –ë–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º –≤ —Ç–æ–Ω–Ω–∞—Ö
                    volume = int(base_volume * company_factor * seasonal_factor * trend_factor * random_factor * 10)
                    
                    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ü–µ–Ω—É —Å —É—á–µ—Ç–æ–º –∏–Ω—Ñ–ª—è—Ü–∏–∏ –∏ —Ä—ã–Ω–æ—á–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤
                    price_trend = 1 + (year - 2018) * 0.08  # –ì–æ–¥–æ–≤–∞—è –∏–Ω—Ñ–ª—è—Ü–∏—è ~8%
                    price_seasonal = np.sin(month / 12 * 2 * np.pi) * 0.1 + 1
                    price_random = np.random.normal(1, 0.1)
                    
                    base_price = base_prices[product]
                    price = int(base_price * price_trend * price_seasonal * price_random)
                    
                    historical_data.append({
                        '–î–∞—Ç–∞': date,
                        '–ö–æ–º–ø–∞–Ω–∏—è': company,
                        '–¢–æ–≤–∞—Ä': product,
                        '–¶–µ–Ω–∞ (—Ä—É–±/—Ç)': price,
                        '–û–±—ä–µ–º (—Ç)': volume,
                        '–í—ã—Ä—É—á–∫–∞ (—Ä—É–±)': price * volume
                    })
    
    return pd.DataFrame(historical_data)

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
companies_df = load_company_data()
export_df = load_export_data()
regions_df = load_region_data()
historical_df = generate_historical_data()

# –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å
st.sidebar.header("üîç –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º")
section = st.sidebar.radio(
    "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:",
    ["üìà –û–±–∑–æ—Ä —Ä—ã–Ω–∫–∞", "üè¢ –ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–∞–Ω–∏–π", "üó∫Ô∏è –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑", "üìä –≠–∫—Å–ø–æ—Ä—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", "üíπ –î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω –∏ –æ–±—ä–µ–º–æ–≤"]
)

# –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ - –û–±–∑–æ—Ä —Ä—ã–Ω–∫–∞
if section == "üìà –û–±–∑–æ—Ä —Ä—ã–Ω–∫–∞":
    st.header("üìà –û–±–∑–æ—Ä —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–µ–≤–æ–¥—Å—Ç–≤–∞")
    
    col1, col2, col3 = st.columns(3)
    
    with col1:
        total_export = companies_df['–≠–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)'].sum()
        st.metric("–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç –∫–æ–º–ø–∞–Ω–∏–π", f"{total_export:,} —Ç–æ–Ω–Ω/–≥–æ–¥")
    
    with col2:
        total_area = companies_df['–ü–æ—Å–µ–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∏ (–≥–∞)'].sum()
        st.metric("–°—É–º–º–∞—Ä–Ω—ã–µ –ø–æ—Å–µ–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∏", f"{total_area:,} –≥–∞")
    
    with col3:
        avg_export_share = companies_df['–î–æ–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ'].str.rstrip('%').astype(float).mean()
        st.metric("–°—Ä–µ–¥–Ω—è—è –¥–æ–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞", f"{avg_export_share:.1f}%")
    
    # –ö–∞—Ä—Ç–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤
    st.subheader("üó∫Ô∏è –≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º")
    
    fig = px.bar(regions_df, 
                 x='–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (—Ç–æ–Ω–Ω)', 
                 y='–†–µ–≥–∏–æ–Ω',
                 orientation='h',
                 title='–≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–µ–≥–∏–æ–Ω–æ–≤ –†–æ—Å—Å–∏–∏',
                 color='–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (—Ç–æ–Ω–Ω)',
                 color_continuous_scale='viridis')
    st.plotly_chart(fig, use_container_width=True)
    
    # –¢–æ–ø –∫–æ–º–ø–∞–Ω–∏–π –ø–æ —ç–∫—Å–ø–æ—Ä—Ç—É
    st.subheader("üèÜ –¢–æ–ø-5 –∫–æ–º–ø–∞–Ω–∏–π –ø–æ –æ–±—ä–µ–º—É —ç–∫—Å–ø–æ—Ä—Ç–∞")
    top_companies = companies_df.nlargest(5, '–≠–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)')[['–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏', '–≠–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)', '–†–µ–≥–∏–æ–Ω –†–§']]
    st.dataframe(top_companies, use_container_width=True)

# –†–∞–∑–¥–µ–ª –∫–æ–º–ø–∞–Ω–∏–π
elif section == "üè¢ –ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–∞–Ω–∏–π":
    st.header("üè¢ –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∞–≥—Ä–æ—Ö–æ–ª–¥–∏–Ω–≥–æ–≤")
    
    # –§–∏–ª—å—Ç—Ä—ã
    col1, col2 = st.columns(2)
    with col1:
        selected_region = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω", ["–í—Å–µ"] + list(companies_df['–†–µ–≥–∏–æ–Ω –†–§'].unique()))
    with col2:
        selected_specialization = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é", ["–í—Å–µ"] + list(companies_df['–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è'].unique()))
    
    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    filtered_companies = companies_df.copy()
    if selected_region != "–í—Å–µ":
        filtered_companies = filtered_companies[filtered_companies['–†–µ–≥–∏–æ–Ω –†–§'] == selected_region]
    if selected_specialization != "–í—Å–µ":
        filtered_companies = filtered_companies[filtered_companies['–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è'] == selected_specialization]
    
    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
    col1, col2 = st.columns(2)
    
    with col1:
        fig1 = px.scatter(filtered_companies, 
                         x='–ü–æ—Å–µ–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∏ (–≥–∞)', 
                         y='–≠–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)',
                         size='–≠–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)',
                         color='–†–µ–≥–∏–æ–Ω –†–§',
                         hover_name='–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏',
                         title='–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ –æ—Ç –ø–æ—Å–µ–≤–Ω—ã—Ö –ø–ª–æ—â–∞–¥–µ–π')
        st.plotly_chart(fig1, use_container_width=True)
    
    with col2:
        if not filtered_companies.empty:
            fig2 = px.pie(filtered_companies, 
                         values='–≠–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)', 
                         names='–†–µ–≥–∏–æ–Ω –†–§',
                         title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º')
            st.plotly_chart(fig2, use_container_width=True)
        else:
            st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤")
    
    # –¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–ø–∞–Ω–∏–π
    st.subheader("üìã –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏—è—Ö")
    display_columns = ['–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏', '–†–µ–≥–∏–æ–Ω –†–§', '–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è', 
                      '–≠–∫—Å–ø–æ—Ä—Ç (—Ç–æ–Ω–Ω/–≥–æ–¥)', '–ü–æ—Å–µ–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∏ (–≥–∞)', '–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∞']
    st.dataframe(filtered_companies[display_columns], use_container_width=True)

# –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
elif section == "üó∫Ô∏è –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑":
    st.header("üó∫Ô∏è –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç–∫—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞")
    
    st.subheader("üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º")
    
    fig = px.bar(regions_df, 
                 x='–†–µ–≥–∏–æ–Ω', 
                 y='–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (—Ç–æ–Ω–Ω)',
                 color='–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (—Ç–æ–Ω–Ω)',
                 title='–≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–µ–≥–∏–æ–Ω–æ–≤ –†–æ—Å—Å–∏–∏')
    st.plotly_chart(fig, use_container_width=True)
    
    st.subheader("üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º")
    
    col1, col2 = st.columns(2)
    
    with col1:
        fig3 = px.pie(regions_df, 
                     values='–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (—Ç–æ–Ω–Ω)', 
                     names='–†–µ–≥–∏–æ–Ω',
                     title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º')
        st.plotly_chart(fig3, use_container_width=True)
    
    with col2:
        selected_region_detail = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞", regions_df['–†–µ–≥–∏–æ–Ω'])
        region_data = regions_df[regions_df['–†–µ–≥–∏–æ–Ω'] == selected_region_detail].iloc[0]
        
        st.info(f"""
        **üìà {selected_region_detail}**
        
        **–≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª:** {region_data['–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (—Ç–æ–Ω–Ω)']:,} —Ç–æ–Ω–Ω
        **–û—Å–Ω–æ–≤–Ω—ã–µ –∫—É–ª—å—Ç—É—Ä—ã:** {region_data['–û—Å–Ω–æ–≤–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ –∫—É–ª—å—Ç—É—Ä—ã']}
        **–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏:** {region_data['–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏-—ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã']}
        **–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** {region_data['–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è']}
        """)

# –≠–∫—Å–ø–æ—Ä—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
elif section == "üìä –≠–∫—Å–ø–æ—Ä—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞":
    st.header("üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —ç–∫—Å–ø–æ—Ä—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.subheader("üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ø–æ —Ç–∏–ø–∞–º –ø—Ä–æ–¥—É–∫—Ü–∏–∏")
        
        export_data = []
        for _, row in export_df.iterrows():
            export_data.append({
                '–ö–æ–º–ø–∞–Ω–∏—è': row['–ö–æ–º–ø–∞–Ω–∏—è'],
                '–¢–∏–ø –ø—Ä–æ–¥—É–∫—Ü–∏–∏': '–ó–µ—Ä–Ω–æ–≤—ã–µ',
                '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞': row['–ó–µ—Ä–Ω–æ–≤—ã–µ —ç–∫—Å–ø–æ—Ä—Ç']
            })
            export_data.append({
                '–ö–æ–º–ø–∞–Ω–∏—è': row['–ö–æ–º–ø–∞–Ω–∏—è'],
                '–¢–∏–ø –ø—Ä–æ–¥—É–∫—Ü–∏–∏': '–ú–∞—Å–ª–∏—á–Ω—ã–µ',
                '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞': row['–ú–∞—Å–ª–∏—á–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç']
            })
        
        export_types_df = pd.DataFrame(export_data)
        
        if not export_types_df.empty:
            fig = px.bar(export_types_df, 
                        x='–ö–æ–º–ø–∞–Ω–∏—è', 
                        y='–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞',
                        color='–¢–∏–ø –ø—Ä–æ–¥—É–∫—Ü–∏–∏',
                        barmode='stack',
                        title='–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤–µ–¥—É—â–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π')
            st.plotly_chart(fig, use_container_width=True)
        else:
            st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞")
    
    with col2:
        st.subheader("üö¢ –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞")
        
        route_counts = export_df['–û—Å–Ω–æ–≤–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã'].value_counts()
        if not route_counts.empty:
            fig2 = px.pie(values=route_counts.values, 
                         names=route_counts.index,
                         title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤')
            st.plotly_chart(fig2, use_container_width=True)
        else:
            st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –º–∞—Ä—à—Ä—É—Ç–∞—Ö")
    
    st.subheader("üìã –î–µ—Ç–∞–ª—å–Ω–∞—è —ç–∫—Å–ø–æ—Ä—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–ø–∞–Ω–∏–π")
    st.dataframe(export_df, use_container_width=True)

# –ù–û–í–´–ô –†–ê–ó–î–ï–õ: –î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω –∏ –æ–±—ä–µ–º–æ–≤
elif section == "üíπ –î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω –∏ –æ–±—ä–µ–º–æ–≤":
    st.header("üíπ –î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω –∏ –æ–±—ä–µ–º–æ–≤ –ø—Ä–æ–¥–∞–∂")
    st.markdown("**–ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∫–æ–º–ø–∞–Ω–∏–π**")
    
    # –§–∏–ª—å—Ç—Ä—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    col1, col2, col3 = st.columns(3)
    
    with col1:
        selected_company = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–ø–∞–Ω–∏—é", historical_df['–ö–æ–º–ø–∞–Ω–∏—è'].unique())
    
    with col2:
        selected_product = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä", historical_df['–¢–æ–≤–∞—Ä'].unique())
    
    with col3:
        year_range = st.slider(
            "–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥",
            min_value=2018,
            max_value=2024,
            value=(2018, 2024)
        )
    
    # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    filtered_data = historical_df[
        (historical_df['–ö–æ–º–ø–∞–Ω–∏—è'] == selected_company) &
        (historical_df['–¢–æ–≤–∞—Ä'] == selected_product) &
        (historical_df['–î–∞—Ç–∞'].dt.year >= year_range[0]) &
        (historical_df['–î–∞—Ç–∞'].dt.year <= year_range[1])
    ].sort_values('–î–∞—Ç–∞')
    
    if not filtered_data.empty:
        # –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        col1, col2, col3, col4 = st.columns(4)
        
        with col1:
            current_price = filtered_data.iloc[-1]['–¶–µ–Ω–∞ (—Ä—É–±/—Ç)']
            st.metric("–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞", f"{current_price:,} —Ä—É–±/—Ç")
        
        with col2:
            avg_price = filtered_data['–¶–µ–Ω–∞ (—Ä—É–±/—Ç)'].mean()
            st.metric("–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥", f"{avg_price:,.0f} —Ä—É–±/—Ç")
        
        with col3:
            total_volume = filtered_data['–û–±—ä–µ–º (—Ç)'].sum()
            st.metric("–û–±—â–∏–π –æ–±—ä–µ–º –ø—Ä–æ–¥–∞–∂", f"{total_volume:,} —Ç")
        
        with col4:
            total_revenue = filtered_data['–í—ã—Ä—É—á–∫–∞ (—Ä—É–±)'].sum()
            st.metric("–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞", f"{total_revenue:,.0f} —Ä—É–±")
        
        # –ì—Ä–∞—Ñ–∏–∫–∏
        col1, col2 = st.columns(2)
        
        with col1:
            st.subheader(f"üìà –î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω: {selected_product}")
            fig_price = px.line(
                filtered_data,
                x='–î–∞—Ç–∞',
                y='–¶–µ–Ω–∞ (—Ä—É–±/—Ç)',
                title=f'–î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω {selected_product} - {selected_company}',
                markers=True
            )
            st.plotly_chart(fig_price, use_container_width=True)
        
        with col2:
            st.subheader(f"üìä –î–∏–Ω–∞–º–∏–∫–∞ –æ–±—ä–µ–º–æ–≤: {selected_product}")
            fig_volume = px.bar(
                filtered_data,
                x='–î–∞—Ç–∞',
                y='–û–±—ä–µ–º (—Ç)',
                title=f'–û–±—ä–µ–º—ã –ø—Ä–æ–¥–∞–∂ {selected_product} - {selected_company}'
            )
            st.plotly_chart(fig_volume, use_container_width=True)
        
        # –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
        st.subheader("üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑")
        
        col1, col2 = st.columns(2)
        
        with col1:
            # –°—Ä–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã –ø–æ –∫–æ–º–ø–∞–Ω–∏—è–º –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
            avg_prices_by_company = historical_df[
                (historical_df['–¢–æ–≤–∞—Ä'] == selected_product) &
                (historical_df['–î–∞—Ç–∞'].dt.year >= year_range[0]) &
                (historical_df['–î–∞—Ç–∞'].dt.year <= year_range[1])
            ].groupby('–ö–æ–º–ø–∞–Ω–∏—è')['–¶–µ–Ω–∞ (—Ä—É–±/—Ç)'].mean().sort_values(ascending=False)
            
            fig_comparison = px.bar(
                x=avg_prices_by_company.values,
                y=avg_prices_by_company.index,
                orientation='h',
                title=f'–°—Ä–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã –Ω–∞ {selected_product} –ø–æ –∫–æ–º–ø–∞–Ω–∏—è–º',
                labels={'x': '–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ (—Ä—É–±/—Ç)', 'y': '–ö–æ–º–ø–∞–Ω–∏—è'}
            )
            st.plotly_chart(fig_comparison, use_container_width=True)
        
        with col2:
            # –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞
            monthly_data = filtered_data.copy()
            monthly_data['–ì–æ–¥-–ú–µ—Å—è—Ü'] = monthly_data['–î–∞—Ç–∞'].dt.to_period('M').astype(str)
            
            fig_monthly = px.scatter(
                monthly_data,
                x='–¶–µ–Ω–∞ (—Ä—É–±/—Ç)',
                y='–û–±—ä–µ–º (—Ç)',
                size='–í—ã—Ä—É—á–∫–∞ (—Ä—É–±)',
                color='–ì–æ–¥-–ú–µ—Å—è—Ü',
                hover_name='–ì–æ–¥-–ú–µ—Å—è—Ü',
                title=f'–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/–æ–±—ä–µ–º {selected_product} - {selected_company}'
            )
            st.plotly_chart(fig_monthly, use_container_width=True)
        
        # –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö
        st.subheader("üìã –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö")
        display_data = filtered_data[['–î–∞—Ç–∞', '–¶–µ–Ω–∞ (—Ä—É–±/—Ç)', '–û–±—ä–µ–º (—Ç)', '–í—ã—Ä—É—á–∫–∞ (—Ä—É–±)']].copy()
        display_data['–î–∞—Ç–∞'] = display_data['–î–∞—Ç–∞'].dt.strftime('%Y-%m')
        st.dataframe(display_data, use_container_width=True)
        
    else:
        st.warning("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤")

# –§—É—Ç–µ—Ä
st.markdown("---")
st.markdown("""
<div style='text-align: center'>
    <p><strong>–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–µ–≤–æ–¥—Å—Ç–≤–∞ –†–æ—Å—Å–∏–∏</strong></p>
    <p>–î–∞–Ω–Ω—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ 2024 –≥–æ–¥ | –ò—Å—Ç–æ—á–Ω–∏–∫: –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–π</p>
</div>
""", unsafe_allow_html=True)
